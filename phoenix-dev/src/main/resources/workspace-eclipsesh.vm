#!/bin/sh

cd `dirname "$0"`
WORKSPACE_HOME=`pwd`
if [ ! -d ws/.metadata -o x$1 = xrefresh ];then
	mvn -Denv=qa eclipse:eclipse
fi

if [[ -z $ECLIPSE_HOME ]];then
	if [ -f /Applications/Eclipse.app/Contents/MacOS/eclipse ];then
		ECLIPSE_HOME=/Applications/Eclipse.app/Contents/MacOS/
	elif [ -f /Applications/eclipse/Eclipse.app/Contents/MacOS/eclipse ];then
		ECLIPSE_HOME=/Applications/eclipse/Eclipse.app/Contents/MacOS/
	fi
fi

grep -i "\-Dfile.encoding=utf-8" $ECLIPSE_HOME/eclipse.ini >/dev/null 2>&1
if [ $? -ne 0 ];then
	echo "-Dfile.encoding=utf-8" >> $ECLIPSE_HOME/eclipse.ini
fi

"$ECLIPSE_HOME"/eclipse -data "$WORKSPACE_HOME"/ws &